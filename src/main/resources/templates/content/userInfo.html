<!DOCTYPE html>
<html lang="ko"
      layout:decorate="~{layout/default_layout}"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <!-- Custom CSS -->
    <link
            href="/assets/libs/select2/dist/css/select2.min.css"
            rel="stylesheet"
            th:href="@{/assets/libs/select2/dist/css/select2.min.css}"
            type="text/css"
    />
    <link
            href="/assets/libs/jquery-minicolors/jquery.minicolors.css"
            rel="stylesheet"
            th:href="@{/assets/libs/jquery-minicolors/jquery.minicolors.css}"
            type="text/css"
    />
    <link
            href="/assets/libs/bootstrap-datepicker/dist/css/bootstrap-datepicker.min.css"
            rel="stylesheet"
            th:href="@{/assets/libs/bootstrap-datepicker/dist/css/bootstrap-datepicker.min.css}"
            type="text/css"
    />
    <link
            href="/assets/libs/quill/dist/quill.snow.css"
            rel="stylesheet"
            th:href="@{/assets/libs/quill/dist/quill.snow.css}"
            type="text/css"
    />
    <style>
        .form-group.required .control-label:after { content:"*";color:red; }
    </style>
    <!-- This Page JS -->
    <script href="/assets/libs/inputmask/dist/min/jquery.inputmask.bundle.min.js"
            th:src="@{/assets/libs/inputmask/dist/min/jquery.inputmask.bundle.min.js}"></script>
    <script href="/dist/js/pages/mask/mask.init.js" th:src="@{/dist/js/pages/mask/mask.init.js}"></script>
    <script href="/assets/libs/select2/dist/js/select2.full.min.js"
            th:src="@{/assets/libs/select2/dist/js/select2.full.min.js}"></script>
    <script href="/assets/libs/select2/dist/js/select2.min.js"
            th:src="@{/assets/libs/select2/dist/js/select2.min.js}"></script>
    <script href="/assets/libs/jquery-asColor/dist/jquery-asColor.min.js"
            th:src="@{/assets/libs/jquery-asColor/dist/jquery-asColor.min.js}"></script>
    <script href="/assets/libs/jquery-asGradient/dist/jquery-asGradient.js"
            th:src="@{/assets/libs/jquery-asGradient/dist/jquery-asGradient.js}"></script>
    <script href="/assets/libs/jquery-asColorPicker/dist/jquery-asColorPicker.min.js"
            th:src="@{/assets/libs/jquery-asColorPicker/dist/jquery-asColorPicker.min.js}"></script>
    <script href="/assets/libs/jquery-minicolors/jquery.minicolors.min.js"
            th:src="@{/assets/libs/jquery-minicolors/jquery.minicolors.min.js}"></script>
    <script href="/assets/libs/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"
            th:src="@{/assets/libs/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js}"></script>
    <script href="/assets/libs/quill/dist/quill.min.js" th:src="@{/assets/libs/quill/dist/quill.min.js}"></script>

    <script href="/assets/libs/jquery-validation/dist/jquery.validate.min.js"
            th:src="@{/assets/libs/jquery-validation/dist/jquery.validate.min.js}"></script>
    <script href="/assets/libs/jquery-validation/dist/additional-methods.js"
            th:src="@{/assets/libs/jquery-validation/dist/additional-methods.js}"></script>
    <script href="/js/jquery-common.js" th:src="@{/js/jquery-common.js}"></script>
    <script th:inline="javascript">
    $(function () {
        $(".select2").select2();

        //좌측 메뉴 활성화
        $(".sidebar-link").each(function(){
           if($(this).attr("href").indexOf("userList") > 0){
               $(this).addClass("active");
               $(this).closest('li').addClass("active");
               $(this).closest('li').closest('ul').addClass("in");
               $(this).closest('li').closest('ul').prev().addClass("active");
               $(this).closest('li').closest('ul').closest('li').addClass('selected');
               return false;
           }
        });

        changeDomain = function(obj){
            if(obj.value != ""){
                $("#emailDomain").val(obj.value);
                $("#emailDomain").attr("readOnly",true);
            }else{
                $("#emailDomain").val('');
                $("#emailDomain").removeAttr("readOnly");
            }
        }



        $("#is_form").validate({
            rules: {
                loginId: {
                    required: true ,
                    regex: /^[a-z0-9\d_-]{4,14}$/
                }
                ,samecheck:{
                    sameidcheck: true
                }
                ,name:{
                    required: true
                }
                /*[# th:if="${member.id == null}"]*/
                ,password:{
                    required: true,
                    regex : /^(?=.*[A-Za-z])(?=.*\d)(?=.*[$@$!%*#?^=-])[A-Za-z\d$@$!%*#?^=-]{8,25}$/
                }
                ,password1:{
                    required: true
                    ,equalTo: "#password"
                }
                /*[/]*/
                /*[# th:if="${member.id != null}"]*/
                ,password:{
                    regex : /^(?=.*[A-Za-z])(?=.*\d)(?=.*[$@$!%*#?^=-])[A-Za-z\d$@$!%*#?^=-]{8,25}$/
                }
                ,mPassword:{
                    required : function(element){
                        return $("#passwd").val() != '' ? true : false;
                    }
                }
                /*[/]*/
                ,emailId:{
                    required: true
                }
                ,emailDomain:{
                    required: true,
                    regex : /^([a-z0-9-]+\.)+[a-z0-9]{2,4}$/
                }
                ,pnum:{
                    required: true,
                    regex : /^01([0|1|6|7|8|9])-(\d{3,4})-(\d{4})$/
                }
                ,rank:{
                    required: true
                }
                ,useYn:{
                    required: true
                }
            },
            messages : {
                loginId : {
                    required: "로그인 아이디는 필수입니다." ,
                    regex: "아이디는 영문소문자, 숫자와 특수문자(_-)만 사용 가능합니다."
                }
                ,samecheck:{
                    sameidcheck: "아이디 중복체크를 해주세요."
                }
                ,name:{
                    required: "이름을 입력해주세요."
                }
                /*[# th:if="${member.id == null}"]*/
                ,password:{
                    required: "비밀번호를 입력해주세요.",
                    regex: "비밀번호는 영문/숫자/특수문자(!@#$%^*+=-)를 모두 사용해야합니다."
                }
                ,password1:{
                    required: "비밀번호확인을 입력해주세요."
                    ,equalTo: "비밀번호와 일치하지 않습니다."
                }
                /*[/]*/
                /*[# th:if="${member.id != null}"]*/
                ,password:{
                    regex: "비밀번호는 영문/숫자/특수문자(!@#$%^*+=-)를 모두 사용해야합니다."
                }
                ,mPassword:{
                    required : "마스터 비밀번호를 입력해주세요."
                }
                /*[/]*/
                ,emailId:{
                    required: "이메일아이디를 입력해주세요."
                }
                ,emailDomain:{
                    required: "이메일도메인을 입력해주세요.",
                    regex : "유효한 도메인을 입력해주세요."
                }
                ,pnum:{
                    required: "연락처를 입력해주세요.",
                    regex : "연락처를 확인하세요."
                }
                ,rank:{
                    required: "직급을 입력해주세요."
                }
                ,useYn:{
                    required: "사용여부를 선택해주세요."
                }

            }
        });

        sameIdCheck = function(){
            var url = '/loginSameCheck';
            $.ajax({
                dataType : 'json'
                , type : 'POST'
                , async : true
                , beforeSend : function (jqXHR, settings) {

                }
                , url : url //for ASP.NET, java
                , data : { loginId: $("#loginId").val() }
                , success : function (changes) {
                    if(!changes){
                        alert("사용중인 아이디입니다.");
                        $("#samecheck").val('false');
                    }else{
                        $("#samecheck").val('true');
                    }
                }
                , complete : function () {

                }
            });
        }
    });

    function listAction(){
        location.href='/userList';
    }

    function cancelAction(){
        if(confirm("등록을 취소하시겠습니까?")){
            location.href='/userList';
        }
    }
    </script>
</head>

<div class="page-wrapper" layout:fragment="content">
    <div class="page-breadcrumb">
        <div class="row">
            <div class="col-12 d-flex no-block align-items-center">
                <h4 class="page-title">관리자 관리</h4>
            </div>
        </div>
    </div>

    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <form class="form-horizontal" id="is_form" method="post" name="is_form" th:action="@{/createUser}"
                          th:object="${member}">
                        <input id="id" name="id" th:value="*{id}" type="hidden">
                        <input id="samecheck" name="samecheck" value="" type="hidden">
                        <div class="card-body">
                            <h4 class="card-title">관리자 등록</h4>
                            <div class="form-group row">
                                <label class="col-md-3"
                                       for="loginId">관리자 구분</label>
                                <div class="col-sm-9">
                                    일반관리자
                                </div>
                            </div>
                            <div class="form-group required row">
                                <label class="col-md-3 control-label"
                                       for="loginId">Login ID</label>
                                <div class="col-sm-9">
                                    <input
                                            class="form-control"
                                            id="loginId"
                                            name="loginId"
                                            placeholder="ID를 입력하세요."
                                            th:errorclass="is-invalid"
                                            th:field="*{loginId}" type="text"
                                    />
                                </div>
                            </div>
                            <div class="form-group required row">
                                <label
                                        class="col-md-3 control-label"
                                        for="name"
                                >이름</label
                                >
                                <div class="col-sm-9">
                                    <input
                                            class="form-control"
                                            id="name"
                                            name="name"
                                            placeholder="이름을 입력하세요."
                                            th:field="*{name}"
                                            type="text"
                                    />
                                </div>
                            </div>
                            <div class="form-group row" th:classappend="*{id} != null ? '' : 'required'">
                                <label
                                        class="col-md-3 " th:classappend="*{id} != null ? '' : 'control-label'"
                                        for="passwd"
                                >비밀번호</label
                                >
                                <div class="col-sm-9">
                                    <input
                                            class="form-control"
                                            id="passwd"
                                            name="password"
                                            placeholder="비밀번호 입력하세요."
                                            type="password"
                                    />
                                </div>
                            </div>
                            <th:block th:if="*{id == null}">
                                <div class="form-group required row">
                                    <label
                                            class="col-md-3 control-label"
                                            for="passwd"
                                    >비밀번호 재입력</label
                                    >
                                    <div class="col-sm-9">
                                        <input
                                                class="form-control"
                                                id="passwd1"
                                                name="password1"
                                                placeholder="비밀번호 재입력하세요."
                                                type="password"
                                        />
                                    </div>
                                </div>
                            </th:block>
                            <th:block th:if="*{id != null}">
                                <div class="form-group row">
                                    <label
                                            class="col-md-3"
                                            for="mpasswd"
                                    >마스터 비밀번호</label
                                    >
                                    <div class="col-sm-9">
                                        <input
                                                class="form-control"
                                                id="mpasswd"
                                                name="mPassword"
                                                placeholder="마스터 비밀번호를 입력하세요."
                                                type="password"
                                        />
                                    </div>
                                </div>
                            </th:block>

                            <div class="form-group required row">
                                <label
                                        class="col-md-3 control-label"
                                        for="emailId"
                                >이메일</label
                                >
                                <div class="col-md-3">
                                    <input
                                            class="form-control"
                                            id="emailId"
                                            name="emailId"
                                            placeholder="이메일 아이디를 입력하세요."
                                            th:field="*{emailId}"
                                            type="text"
                                    />
                                </div>
                                @
                                <div class="col-md-3">
                                    <input
                                            class="form-control"
                                            id="emailDomain"
                                            name="emailDomain"
                                            placeholder="이메일 도메인을 입력하세요."
                                            th:field="*{emailDomain}"
                                            type="text"
                                    />
                                </div>
                                <div class="col-md-2">
                                    <select aria-hidden="true"
                                            class="select2 form-select shadow-none select2-hidden-accessible"
                                            data-select2-id="1" onchange="changeDomain(this);"
                                            style="width: 100%; height: 36px" tabindex="-1">
                                        <option th:selected="*{emailDomain} == ''" value="">직접입력</option>
                                        <option th:selected="*{emailDomain} == 'naver.com'" value="naver.com">
                                            naver.com
                                        </option>
                                        <option th:selected="*{emailDomain} == 'daum.net'" value="daum.net">daum.net
                                        </option>
                                        <option th:selected="*{emailDomain} == 'gmail.com'" value="gmail.com">
                                            gmail.com
                                        </option>
                                    </select>
                                </div>

                            </div>
                            <div class="form-group required row">
                                <label
                                        class="col-md-3 control-label"
                                        for="pnum"
                                >연락처</label>
                                <div class="col-sm-9">
                                    <input
                                            class="form-control"
                                            id="pnum"
                                            name="pnum"
                                            placeholder="연락처를 입력하세요."
                                            th:field="*{pnum}"
                                            type="text"
                                    />
                                </div>
                            </div>
                            <div class="form-group row">
                                <label
                                        class="col-md-3"
                                        for="rank">직급</label>
                                <div class="col-sm-9">
                                    <input class="form-control" id="rank" name="rank" placeholder="직급을 입력하세요."
                                           th:field="*{rank}"
                                           type="text"/>
                                </div>
                            </div>
                            <div class="form-group required row">
                                <label class="col-md-3 control-label">사용여부</label>
                                <div class="col-md-9">
                                    <div class="form-check">
                                        <input class="form-check-input" id="useYn1" name="useYn" required=""
                                               th:checked="useYn == 'Y'"
                                               th:field="*{useYn}"
                                               type="radio" value="Y">
                                        <label class="form-check-label mb-0" for="useYn1">사용</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" id="useYn2" name="useYn" required=""
                                               th:checked="useYn == 'N'"
                                               th:field="*{useYn}"
                                               type="radio" value="N">
                                        <label class="form-check-label mb-0" for="useYn2">미사용</label>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-md-3">권한구분</label>
                                <div class="col-md-9">
                                    <div class="form-check mr-sm-2">
                                        <input class="form-check-input" id="mainAuthority" name="mainAuthority"
                                               th:field="*{mainAuthority}" th:value="Y"
                                               type="checkbox">
                                        <label clas="form-check-label mb-0" for="mainAuthority">메인관리</label>
                                    </div>
                                    <div class="form-check mr-sm-2">
                                        <input class="form-check-input" id="noticeAuthority" name="noticeAuthority"
                                               th:field="*{noticeAuthority}" th:value="Y"
                                               type="checkbox">
                                        <label class="form-check-label mb-0" for="noticeAuthority">공지사항관리</label>
                                    </div>
                                    <div class="form-check mr-sm-2">
                                        <input class="form-check-input" id="logAuthority" name="logAuthority"
                                               th:field="*{logAuthority}" th:value="Y"
                                               type="checkbox">
                                        <label class="form-check-label mb-0" for="noticeAuthority">로그관리</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="border-top" style="text-align:center;">
                            <div class="card-body">
                                <button class="btn btn-secondary text-white" onclick="listAction();"
                                        type="button">
                                    목록
                                </button>
                                <button class="btn btn-success text-white" onclick="$('#is_form').submit();"
                                        type="button">
                                    등록
                                </button>
                                <button class="btn btn-danger text-white" onclick="cancelAction();" type="button">
                                    취소
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>


</div>

</html>